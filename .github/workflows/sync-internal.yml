name: SyncRepositories

on:
  push:
    branches: ["staging"]

jobs:
  deploy:
    name: deploy
    runs-on: ubuntu-latest
    steps:
      - name: Set up Go 1.14
        uses: actions/setup-go@v1
        with:
          go-version: 1.14
        id: go
      - name: Check out code
        uses: actions/checkout@v2
      - name: deploy2
        env:
          SECRET_GITHUB_TOKEN: ${{ secrets.SECRET_GITHUB_TOKEN }}
        run: |
          if [[ -z "$SECRET_GITHUB_TOKEN" ]]
          then
              echo "Variable SECRET_GITHUB_TOKEN is required"
              exit 1
          fi
          git clone -b develop "https://$SECRET_GITHUB_TOKEN@github.com:ZupIT/horusec.git" tmp-horusec-open-source
          git clone -b develop "https://$SECRET_GITHUB_TOKEN@github.com:ZupIT/horusec-internal.git" tmp-horusec-internal
          ls
      #     BRANCH_NAME=${GITHUB_REF##*/}

      #     chmod +x ./deployments/scripts/sync-internal.sh
      #     ./deployments/scripts/sync-internal.sh "develop" "$SECRET_GITHUB_TOKEN"
      #     cd tmp-horusec-internal
      #     git status
      # - name: Commit changes
      #   uses: EndBug/add-and-commit@v4
      #   with:
      #     cwd: './tmp-horusec-internal'
      #     author_name: "Horusec"
      #     author_email: "horusec@zup.com.br"
      #     message: "[skip cicd] update versioning file"
      #     GITHUB_TOKEN: ${{ secrets.SECRET_GITHUB_TOKEN }}
